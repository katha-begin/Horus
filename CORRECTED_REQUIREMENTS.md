# âœ… CORRECTED Requirements - Horus VFX Review Application
## Based on CURRENT UI Design - 2025-12-15

**IMPORTANT:** DO NOT REDESIGN THE UI! Keep current design!

---

## ğŸ¨ **CURRENT UI DESIGN (DO NOT CHANGE)**

### **Three-Panel Layout:**

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Open RV Main Window                       â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ“ SEARCH & NAVIGATE    â”‚   ğŸ’¬ COMMENTS & ANNOTATIONS      â”‚
â”‚  (Left Dock)             â”‚   (Right Dock)                   â”‚
â”‚                          â”‚                                   â”‚
â”‚  Horus Project: [SWA â–¼]  â”‚   Filter: [Ep02 â–¼] [Author â–¼]   â”‚
â”‚  [Refresh]               â”‚   Sort: [Latest â–¼]               â”‚
â”‚                          â”‚                                   â”‚
â”‚  Search: [...]           â”‚   ğŸ‘¤ director.smith              â”‚
â”‚                          â”‚      "Great work!"                â”‚
â”‚  â”Œâ”€ FILTERS â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚      ğŸ’¬ Reply                    â”‚
â”‚  â”‚ Department: [All â–¼] â”‚ â”‚                                   â”‚
â”‚  â”‚ Episode: [Ep02 â–¼]   â”‚ â”‚   ğŸ’­ Add comment... [âœ“]         â”‚
â”‚  â”‚ Sequence: [sq0010â–¼] â”‚ â”‚                                   â”‚
â”‚  â”‚ Shot: [All â–¼]       â”‚ â”‚                                   â”‚
â”‚  â”‚ Status: [All â–¼]     â”‚ â”‚                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                                   â”‚
â”‚                          â”‚                                   â”‚
â”‚  Media Files:            â”‚                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚                                   â”‚
â”‚  â”‚ğŸ“·â”‚Taskâ”‚Nameâ”‚Verâ”‚âœ“ â”‚ â”‚                                   â”‚
â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤ â”‚                                   â”‚
â”‚  â”‚ğŸ¬â”‚SH10â”‚compâ”‚v07â”‚âœ“â”‚ â”‚                                   â”‚
â”‚  â”‚ğŸ¬â”‚SH10â”‚compâ”‚v06â”‚â³â”‚ â”‚                                   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚                                   â”‚
â”‚                          â”‚                                   â”‚
â”‚  Scale: [Small â–¼]        â”‚                                   â”‚
â”‚                          â”‚                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ¬ TIMELINE PLAYLIST MANAGER (Bottom Dock)                 â”‚
â”‚                                                              â”‚
â”‚  Playlists:              Timeline:                          â”‚
â”‚  â–¶ Daily Review          â–ˆâ–ˆâ–ˆâ–ˆ SH0010 â–ˆâ–ˆâ–ˆâ–ˆ SH0020           â”‚
â”‚  â–¶ Weekly Review         â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“â–“ â”‚
â”‚                                                              â”‚
â”‚  [New] [Duplicate] [Rename] [Delete]  [Play] [Stop]        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… **What to KEEP (Current Design)**

### **1. Left Panel - "Search & Navigate - Horus"**
- âœ… Horus Project dropdown
- âœ… Refresh button
- âœ… Search input box
- âœ… **Dropdown filters** (NOT tree view):
  - Department: [All â–¼]
  - Episode: [All â–¼]
  - Sequence: [All â–¼]
  - Shot: [All â–¼]
  - Status: [All â–¼]
- âœ… Media table with columns:
  - Thumbnail
  - Task Entity
  - Name
  - Version
  - Status
  - Created
- âœ… Scale control: [Small â–¼] [Medium] [Large]
- âœ… Sorting enabled (click headers)
- âœ… Double-click to load in RV

### **2. Right Panel - "Comments & Annotations"**
- âœ… Threaded comments (Facebook/Slack style)
- âœ… Reply functionality
- âœ… User avatars and timestamps
- âœ… Add comment input box

### **3. Bottom Panel - "Timeline Playlist Manager"**
- âœ… Playlist tree on left
- âœ… Timeline visualization on right
- âœ… Buttons: New, Duplicate, Rename, Delete, Play, Stop

---

## ğŸ”§ **What to UPDATE (Backend Only)**

### **1. Storage Location - Move to Project Root**
```
OLD: ~/.horus/projects/SWA/comments/
NEW: /mnt/igloo_swa_v/SWA/.horus/comments/Ep02.json

OLD: ~/.horus/projects/SWA/playlists/
NEW: /mnt/igloo_swa_v/SWA/.horus/playlists/daily_review.json
```

### **2. Status Values - Change to 3 States**
```
OLD: "pending", "under_review", "approved"
NEW: "submit", "need fix", "approved"
```

### **3. Filter Dropdowns - Populate from Server**
```python
# Current (hardcoded):
episode_filter.addItems(["All", "Ep00", "Ep01", "Ep02"])

# New (from server scan):
episodes = scan_episodes()  # Returns ["Ep01", "Ep02", "Ep03", "Ep04"]
episode_filter.addItems(["All"] + episodes)
```

### **4. Media Table - Populate from Server**
```python
# Current (from sample_db JSON):
media_records = load_from_json("sample_db/media_records.json")

# New (from file system scan):
media_files = find_media_files(episode, sequence, shot, department)
populate_media_table(media_files)
```

### **5. Add Right-Click Context Menu**
```python
def show_context_menu(position):
    menu = QMenu()
    
    # Check if movie exists
    if has_movie:
        menu.addAction("â–¶ Open Movie (.mov)", open_movie)
    
    # Check if image sequence exists
    if has_image_seq:
        menu.addAction("â–¶ Open Image Sequence (.exr)", open_image_sequence)
    
    menu.addSeparator()
    menu.addAction("â• Add to Playlist", add_to_playlist)
    menu.addAction("ğŸ“ Show in File System", show_in_filesystem)
    
    menu.exec_(media_table.viewport().mapToGlobal(position))

media_table.setContextMenuPolicy(Qt.CustomContextMenu)
media_table.customContextMenuRequested.connect(show_context_menu)
```

### **6. Add Annotation File Path to Data**
```json
{
  "media_file": "/mnt/.../Ep02_sq0010_SH0010_v007.mov",
  "annotation_file": "/mnt/.../Ep02_sq0010_SH0010_comp_v007_annotations.json",
  "shot_status": "submit"
}
```

---

## ğŸš€ **Implementation Tasks (Backend Only)**

### **Phase 1: File System Scanner**
1. Create `FileSystemScanner` class
2. Implement cascade scanning (episodes â†’ sequences â†’ shots)
3. Update filter dropdowns to use scanned data
4. Update media table to show scanned files
5. Load shot metadata from `.json` files

### **Phase 2: Context Menu**
1. Add right-click handler to media table
2. Check for .mov and .exr availability
3. Implement "Open Movie" action
4. Implement "Open Image Sequence" action
5. Implement "Add to Playlist" action

### **Phase 3: Storage Migration**
1. Create `.horus/comments/` directory on server
2. Create `.horus/playlists/` directory on server
3. Migrate comment structure to single-file-per-episode
4. Update `CommentManager` to read/write to new location
5. Update `PlaylistManager` to read/write to new location

### **Phase 4: Status Update**
1. Change status values in code
2. Update status filter dropdown
3. Update status badges (ğŸŸ¡ submit, ğŸ”´ need fix, ğŸŸ¢ approved)
4. Update comment structure with new status values

---

## âŒ **What NOT to Do**

- âŒ DO NOT change UI layout
- âŒ DO NOT redesign panels
- âŒ DO NOT change from dropdown filters to tree view
- âŒ DO NOT change table columns
- âŒ DO NOT remove existing features
- âŒ DO NOT change panel positions (left/right/bottom)

---

## âœ… **Summary**

**KEEP:**
- Current three-panel layout
- Dropdown filters (NOT tree view)
- Media table with current columns
- Comments panel with threading
- Timeline Playlist Manager

**UPDATE:**
- Backend data source (file system instead of JSON)
- Storage location (project root instead of local)
- Status values (3 states instead of many)
- Add right-click context menu
- Add annotation file path to data

**DO NOT CHANGE:**
- UI design
- Panel layout
- Widget types
- User workflow


